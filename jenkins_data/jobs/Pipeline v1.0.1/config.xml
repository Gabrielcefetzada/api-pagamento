<?xml version='1.1' encoding='UTF-8'?>
<flow-definition plugin="workflow-job@1549.vc8d7f497b_22f">
  <actions>
    <org.jenkinsci.plugins.pipeline.modeldefinition.actions.DeclarativeJobAction plugin="pipeline-model-definition@2.2221.vc657003fb_d93"/>
    <org.jenkinsci.plugins.pipeline.modeldefinition.actions.DeclarativeJobPropertyTrackerAction plugin="pipeline-model-definition@2.2221.vc657003fb_d93">
      <jobProperties/>
      <triggers/>
      <parameters/>
      <options/>
    </org.jenkinsci.plugins.pipeline.modeldefinition.actions.DeclarativeJobPropertyTrackerAction>
  </actions>
  <description></description>
  <keepDependencies>false</keepDependencies>
  <properties/>
  <definition class="org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition" plugin="workflow-cps@4046.v90b_1b_9edec67">
    <script>pipeline {
    agent any
    
    environment {
        DB_CONNECTION = &apos;sqlite&apos;
        DB_DATABASE = &apos;database/database.sqlite&apos;
    }
    
    stages {
        stage(&apos;Checkout&apos;) {
            steps {
                sh &apos;&apos;&apos;
                    # Limpar workspace
                    rm -rf * .git .??* 2&gt;/dev/null || true
                    
                    # Clonar repositório
                    git clone https://github.com/Gabrielcefetzada/api-pagamento.git .
                &apos;&apos;&apos;
            }
        }
        
        stage(&apos;Setup Environment&apos;) {
            steps {
                sh &apos;&apos;&apos;
                    # Configurar .env
                    php -r &quot;file_exists(&apos;.env&apos;) || copy(&apos;.env.example&apos;, &apos;.env&apos;);&quot;
                    
                    # Instalar dependências
                    composer install -q --no-ansi --no-interaction --no-scripts --no-progress --prefer-dist
                    
                    # Gerar chave da aplicação
                    php artisan key:generate
                    
                    # Configurar permissões
                    chmod -R 777 storage bootstrap/cache
                    
                    # Criar banco SQLite
                    mkdir -p database
                    touch database/database.sqlite
                &apos;&apos;&apos;
            }
        }
        
        stage(&apos;Run Tests&apos;) {
            steps {
                sh &apos;php artisan test&apos;
            }
        }
    }
    
    post {
        always {
            cleanWs()
        }
    }
}</script>
    <sandbox>true</sandbox>
  </definition>
  <triggers/>
  <disabled>false</disabled>
</flow-definition>